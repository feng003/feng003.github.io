<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">
        <title>javascript Ninja 之 regexp - wiki</title>
        <meta name="keywords" content="个人wiki"/>
        <meta name="description" content="个人wiki"/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
        <div id="container">
            
<div id="header">
  <div id="post-nav"><a href="/">Home</a>&nbsp;»&nbsp;<a href="/#javascript">javascript</a>&nbsp;»&nbsp;<a href="/#javascript-ECMAScript6">ECMAScript6</a>&nbsp;»&nbsp;javascript Ninja 之 regexp</div>
</div>
<div class="clearfix"></div>
<div id="title">javascript Ninja 之 regexp</div>
  <div id="content">
  <ol>
<li>正则表达式进修</li>
<li>编译正则表达式</li>
<li>捕捉操作</li>
<li>常用正则表达式</li>
</ol>
<blockquote>
<p>demo</p>
</blockquote>
<div class="hlcode"><pre>            <span class="cm">/**</span>
<span class="cm">            * 99999-9999 判断是否符号美国邮政编码</span>
<span class="cm">            * @param candidate</span>
<span class="cm">            * @returns {boolean}</span>
<span class="cm">            */</span>
            <span class="kd">function</span> <span class="nx">isThisAZipCode</span><span class="p">(</span><span class="nx">candidate</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">candidate</span> <span class="o">!==</span> <span class="s1">&#39;string&#39;</span> <span class="o">||</span> <span class="nx">candidate</span><span class="p">.</span><span class="nx">length</span> <span class="o">!=</span> <span class="mi">10</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
                <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">n</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">n</span><span class="o">&lt;</span><span class="nx">candidate</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">n</span><span class="o">++</span><span class="p">){</span>
                    <span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">candidate</span><span class="cp">[</span><span class="nb">n</span><span class="cp">]</span><span class="p">;</span>
                    <span class="k">switch</span><span class="p">(</span><span class="nx">n</span><span class="p">){</span>
                        <span class="k">case</span> <span class="mi">0</span><span class="o">:</span> <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="k">case</span> <span class="mi">3</span><span class="o">:</span> <span class="k">case</span> <span class="mi">4</span><span class="o">:</span> <span class="k">case</span> <span class="mi">6</span><span class="o">:</span> <span class="k">case</span> <span class="mi">7</span><span class="o">:</span> <span class="k">case</span> <span class="mi">8</span><span class="o">:</span> <span class="k">case</span> <span class="mi">9</span><span class="o">:</span>
                            <span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="o">&lt;</span><span class="s1">&#39;0&#39;</span> <span class="o">||</span> <span class="nx">c</span><span class="o">&gt;</span> <span class="s1">&#39;9&#39;</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
                            <span class="k">break</span><span class="p">;</span>
                        <span class="k">case</span> <span class="mi">5</span><span class="o">:</span>
                            <span class="k">if</span><span class="p">(</span><span class="nx">c</span> <span class="o">!=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
                            <span class="k">break</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="kd">function</span> <span class="nx">isThisAZipCode</span><span class="p">(</span><span class="nx">candidate</span><span class="p">){</span>
                <span class="k">return</span> <span class="sr">/^\d{5}-\d{4}$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">candidate</span><span class="p">);</span>
            <span class="p">}</span>
</pre></div>


<blockquote>
<p>advance</p>
</blockquote>
<ol>
<li>regular express </li>
</ol>
<h4 id="regexp">创建正则表达式：通过正则表达式字面量，或者通过构造RegExp对象的实例</h4>
<div class="hlcode"><pre>            <span class="n">var</span> <span class="n">pattern</span> <span class="o">=</span> <span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">ig</span><span class="p">;</span>
            <span class="n">var</span> <span class="n">pattern</span> <span class="o">=</span> <span class="n">new</span> <span class="n">RegExp</span><span class="p">(</span><span class="err">&#39;</span><span class="n">text</span><span class="sc">&#39;,&#39;</span><span class="n">ig</span><span class="err">&#39;</span><span class="p">);</span>
</pre></div>


<h4 id="i-g-m">i 让正则表达式不区分大小写 ;g 匹配模式中的所有实例; m 允许匹配多个行</h4>
<ol>
<li>term and operate</li>
</ol>
<h4 id="_1">精确匹配</h4>
<div class="hlcode"><pre>            <span class="o">/</span><span class="n">test</span><span class="o">/</span>
</pre></div>


<h4 id="_2">匹配一类字符</h4>
<div class="hlcode"><pre>            <span class="p">[</span><span class="n">abc</span><span class="p">]</span>
            <span class="p">[</span><span class="o">^</span><span class="n">abc</span><span class="p">]</span>
            <span class="p">[</span><span class="n">a</span><span class="o">-</span><span class="n">m</span><span class="p">]</span>
</pre></div>


<h4 id="92-">转义 使用 \ 对任意字符进行转义，两个反斜杠 \ 匹配一个反斜杠。 特殊字符比如 $  .  [  ]  -  ^</h4>
<h4 id="and">匹配开始和结束  ^ and $</h4>
<div class="hlcode"><pre>             <span class="o">/^</span><span class="n">test</span><span class="err">$</span><span class="o">/</span>
</pre></div>


<h4 id="_3">重复出现 默认贪婪，匹配所有的字符组合；非贪婪(操作符后面加一个问号)进行最小限度的匹配。</h4>
<div class="hlcode"><pre>            <span class="o">/</span><span class="n">a</span><span class="o">+/</span>     
            <span class="o">/</span><span class="n">a</span><span class="o">+?/</span>
            <span class="o">/</span><span class="n">t</span><span class="o">?</span><span class="n">est</span><span class="o">/</span>
            <span class="o">/</span><span class="n">t</span><span class="o">+</span><span class="n">est</span><span class="o">/</span>
            <span class="o">/</span><span class="n">t</span><span class="o">*</span><span class="n">est</span><span class="o">/</span>
            <span class="o">/</span><span class="n">a</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span><span class="o">/</span>
            <span class="o">/</span><span class="n">a</span><span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">}</span><span class="o">/</span>
            <span class="o">/</span><span class="n">a</span><span class="p">{</span><span class="mi">4</span><span class="p">,}</span><span class="o">/</span>
</pre></div>


<h4 id="_4">预定义字符类</h4>
<div class="hlcode"><pre>                <span class="err">\</span><span class="n">r</span>
                <span class="err">\</span><span class="n">n</span>
                <span class="err">\</span><span class="n">d</span>
                <span class="err">\</span><span class="n">w</span>
                <span class="err">\</span><span class="n">s</span>
</pre></div>


<h4 id="_5">分组 用括号进行分组时，同时也创建所谓的捕获</h4>
<div class="hlcode"><pre>            <span class="o">/</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span><span class="o">+/</span>
</pre></div>


<h4 id="or">或 操作符(OR)</h4>
<div class="hlcode"><pre>            <span class="o">/</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span><span class="o">+|</span><span class="p">(</span><span class="n">cd</span><span class="p">)</span><span class="o">+/</span>
</pre></div>


<h4 id="_6">反向引用</h4>
<div class="hlcode"><pre>            <span class="o">/^</span><span class="p">(</span><span class="n">dtn</span><span class="p">)</span><span class="n">a</span><span class="err">\</span><span class="mi">1</span><span class="o">/</span>
            <span class="o">/&lt;</span><span class="p">(</span><span class="err">\</span><span class="n">w</span><span class="o">+</span><span class="p">)</span><span class="o">&gt;</span><span class="p">(.</span><span class="o">+</span><span class="p">)</span><span class="o">&lt;</span><span class="err">\</span><span class="o">/</span><span class="mi">1</span><span class="o">&gt;/</span>
</pre></div>


<blockquote>
<p>compile regexp express</p>
</blockquote>
<div class="hlcode"><pre>        <span class="kd">function</span> <span class="nx">findClassInElements</span><span class="p">(</span><span class="nx">className</span><span class="p">,</span><span class="nx">type</span><span class="p">){</span>
            <span class="kd">var</span> <span class="nx">elems</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">type</span> <span class="o">||</span> <span class="s2">&quot;*&quot;</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">regex</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;(^|\\s)&quot;</span> <span class="o">+</span> <span class="nx">className</span> <span class="o">+</span> <span class="s2">&quot;(\\s|$)&quot;</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="cp">[]</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">elems</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">regex</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">elems</span><span class="cp">[</span><span class="nx">i</span><span class="cp">]</span><span class="p">.</span><span class="nx">className</span><span class="p">)){</span>
                    <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">elems</span><span class="cp">[</span><span class="nx">i</span><span class="cp">]</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
        <span class="p">}</span>
</pre></div>


<blockquote>
<p>capture</p>
</blockquote>
<ol>
<li>
<p>执行简单的捕获</p>
</li>
<li>
<p>用全局表达式进行匹配</p>
</li>
<li>
<p>捕获的引用</p>
</li>
<li>
<p>没有捕获的分组</p>
</li>
</ol>
<blockquote>
<p>replace </p>
</blockquote>
<div class="hlcode"><pre>            <span class="s2">&quot;ABCDEFghi&quot;</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="c1">/</span><span class="cp">[</span><span class="nx">A</span><span class="na">-Z</span><span class="cp">]</span><span class="c1">/g,&quot;X&quot;);</span>

            <span class="kd">function</span> <span class="nx">upper</span><span class="p">(</span><span class="nx">all</span><span class="p">,</span><span class="nx">letter</span><span class="p">){</span>
                <span class="k">return</span> <span class="nx">letter</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="s2">&quot;border-bottom-width&quot;</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/-(\w)/g</span><span class="p">,</span><span class="nx">upper</span><span class="p">);</span>

            <span class="kd">function</span> <span class="nx">compress</span><span class="p">(</span><span class="nx">source</span><span class="p">){</span>
                <span class="kd">var</span> <span class="nx">keys</span> <span class="o">=</span> <span class="p">{};</span>
                <span class="nx">source</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/(</span><span class="cp">[</span><span class="p">^</span><span class="o">=&amp;</span><span class="cp">]</span><span class="sr">+)=(</span><span class="cp">[</span><span class="p">^</span><span class="err">$</span><span class="cp">]</span><span class="sr">*)/g</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">full</span><span class="p">,</span><span class="nx">key</span><span class="p">,</span><span class="nx">value</span><span class="p">){</span>
                    <span class="nx">keys</span><span class="cp">[</span><span class="nb">key</span><span class="cp">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">keys</span><span class="cp">[</span><span class="nb">key</span><span class="cp">]</span> <span class="o">?</span> <span class="nx">keys</span><span class="cp">[</span><span class="nb">key</span><span class="cp">]</span><span class="o">+</span><span class="s2">&quot;,&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">value</span><span class="p">;</span>
                    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
                <span class="p">});</span>
                <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="cp">[]</span><span class="p">;</span>
                <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">keys</span><span class="p">){</span>
                    <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">key</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">+</span> <span class="nx">keys</span><span class="cp">[</span><span class="nb">key</span><span class="cp">]</span><span class="p">);</span>
                <span class="p">}</span>

                <span class="k">return</span> <span class="nx">result</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">assert</span><span class="p">(</span><span class="nx">compress</span><span class="p">(</span><span class="s2">&quot;foo=1&amp;foo=3&amp;foo=4&amp;bar=1&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;foo=1,3,4&amp;bar=1&quot;</span><span class="p">,</span><span class="s2">&quot;OK&quot;</span><span class="p">);</span>
</pre></div>
</div>

        </div>
        <div id="footer">
            <span>
                Copyright © 2017 feng003.
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
            </span>
        </div>
        
    </body>
</html>